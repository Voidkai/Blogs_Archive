# 常见ARM 2440汇编指令解析

# 常见ARM 2440 汇编指令解析

## 分支跳转指令 B，BL
##### 程序流程的跳转有两种实现方法

| 指令 |     作用     |
| :--: | :----------: |
|  B   |   分支指令   |
|  BL  | 相对跳转指令 |

## 数据处理指令
### 移位操作指令
| 指令 |                  作用                   |
| :--: | :-------------------------------------: |
| LSL  |           逻辑左移，最低位补0           |
| LSR  |           逻辑右移，最高位补0           |
| ASR  |  算术右移，最高为补符号位，最低位舍弃   |
| ROR  |     循环右移，最低位变成新的最高位      |
| RRX  | 带扩展位的循环右移，最高位扩展CPSR的C位 |

### 数据传输指令
| 指令 |   作用   |
| :--: | :------: |
| MOV  | 数据传输 |

**指令格式： MOV{cond} {s} Rd, operand**

* cond : 可以条件执行
* s: 操作结果影响cpsr N/Z/C位
* Rd： 目标寄存器
* operand： 目标操作数
    - 立即数： eg.#1
    - 寄存器： eg.r1
    - 寄存器移位之后的值：eg. r1, LSL #2

### 算术运算操作指令

| 指令 |    作用    |
| :--: | :--------: |
| ADD  |    加法    |
| ADC  | 带进位加法 |
| SUB  |    减法    |

## 数据栈操作指令

根据数据栈指针的位置以及栈增长的方向的不同，将数据栈分为四类：

|         类型         | 加载/存储 | SP变化 |
| :------------------: | :-------: | :----: |
| FD: Full Descending  |   Load    |  减小  |
| ED: Empty Descending |   Save    |  减小  |
|  FA: Full Ascending  |   Load    |  增大  |
| EA: Empty Ascending  |   Save    |  增大  |

对数据栈的操作分为Load以及Save两类得到如下八个指令：

* LDMFA： LDMFA SP!,{R0~R7, LR}
* LDMFD： LDMFD SP!,{R0~R7, LR}
* LDMEA： LDMEA SP!,{R0~R7, LR}
* LDMED： LDMED SP!,{R0~R7, LR}
* STMED： STMED SP!,{R0~R7, LR}
* STMEA： STMEA SP!,{R0~R7, LR}
* STMFD： STMFD SP!,{R0~R7, LR} 
* STMFA： STMFA SP!,{R0~R7, LR}

## 寄存器/存储器数据操作指令
ARM微处理器支持加载/存储指令用于在寄存器和存储器之间传送数据，加载指令用于将存储器中的数据传送到寄存器，存储指令则完成相反的操作。常用的加载存储指令如下：

| 指令 |      作用      |
| :--: | :------------: |
| LDR  |   字数据加载   |
| LDRB |  字节数据加载  |
| LDRH | 半字节数据加载 |
| STR  |   字数据存储   |
| STRB |  字节数据存储  |
| STRH | 半字节数据存储 |

指令示例：
***

* LDR   R0，[R1]      ；将存储器地址为R1的字数据读入寄存器R0。
* LDR   R0，[R1，R2]    ；将存储器地址为R1+R2的字数据读入寄存器R0。
* LDR   R0，[R1，＃8]       ；将存储器地址为R1+8的字数据读入寄存器R0。
* LDR   R0，[R1，R2] ！           ；将存储器地址为R1+R2的字数据读入寄存器R0，并将新地址R1＋R2写入R1。
* LDR   R0，[R1，＃8] ！          ；将存储器地址为R1+8的字数据读入寄存器R0，并将新地址R1＋8写入R1。
* LDR   R0，[R1]，R2              ；将存储器地址为R1的字数据读入寄存器R0，并将新地址R1＋R2写入R1。
* LDR   R0，[R1，R2，LSL＃2]！   ；将存储器地址为R1＋R2×4的字数据读入寄存器R0，并将新地址R1＋R2×4写入R1。
* LDR   R0，[R1]，R2，LSL＃2     ；将存储器地址为R1的字数据读入寄存器R0，并将新地址R1＋R2×4写入R1。
***

* STR   R0，[R1]，＃8    ；将R0中的字数据写入以R1为地址的存储器中，并将新地址R1＋8写入R1。
* STR   R0，[R1，＃8]    ；将R0中的字数据写入以R1＋8为地址的存储器中
***

### 状态寄存器与通用寄存器之间传送指令



| 指令 |          解释          |
| :--: | :--------------------: |
| MRS  | 状态寄存器到通用寄存器 |
| MSR  | 通用寄存器到状态寄存器 |

**指令的语法格式**

MRS{< cond >}< Rd >,CPSR

MSR{< cond >} CPSR_< fields >, < Rm >